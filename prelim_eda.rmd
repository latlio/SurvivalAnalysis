---
title: "Survival Analysis Project: Preliminary EDA"
author: "Madison Hobbs & Lathan Liou"
class: "MATH150: Methods in Biostatistics"
date: "4/2/2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(GGally)
data <- read_csv("AIDSdata.csv")
```

# Introduction
Our project seeks to understand time of survival until an AIDS defining event or death. In the first phase of our project, we want to understand the distributions of our time-to-event variables and the remaining explanatory variables. Further, we are curious to see whether there exists correlated relationships between any of our explanatory variables. This will be important during our modeling phase when we have to consider whether to include correlated variables or not.

# Exploratory Data Analysis: Correlation
We present a pairs plot of our explanatory variables, excluding id, our time-to-event variables, and our censoring variables to 1) visualize the distribution of the variables and 2) identify potential pair-wise correlation. \texttt{cd4} and \texttt{strat2} have a correlation coefficient of 0.74, which indicates moderate to strong correlation. This makes sense since \texttt{strat2} is the indicator variable for the continuous variable, \texttt{cd4}. Additionally, in our data, \texttt{tx} and \texttt{txgrp} are the same since the data only contains \texttt{txgrp} values of 1 and 2. Lastly, we would like to note that \texttt{sex}, \texttt{ivdrug}, and \texttt{hemophil} are highly unbalanced variables, meaning that one level of the variables is disproportionately represented relative to the other level(s).

```{r, fig.height=8, fig.width=13}
data %>%
  select(tx:age) %>%
  ggpairs()
```

There are in fact 8 people who were diagnosed and died at different times. Otherwise, for non-censrored individuals, death time was the same as diagnosis time.

```{r}
filter(data, censor == 1, time != time_d, censor_d==1) 
filter(data, censor == 1, censor_d==0)  # who were diagnosed but ended up living
```

No one was on the 3 nor 4 treatments. 

```{r}
data %>% group_by(txgrp) %>% summarise(n())
ggplot(data, aes(x = txgrp)) + geom_histogram()
```




```{r}
non_censored = data %>% filter(censor == 1)

ggplot(data, aes(x = time))
```

Keep 

```{r}
non_censored_diag <- data %>% filter(censor == 1)
non_censored_death <- data %>% filter(censor_d == 1)
ggplot(non_censored_diag, aes(x = time)) + geom_histogram() + facet_grid(.~tx)
ggplot(data, aes(x = time_d)) + geom_histogram() + facet_grid(.~tx)
```

Having prior zdv doesn't really help you:

```{r}
non_censored_diag <- data %>% filter(censor == 1)
ggplot(non_censored_diag, aes(x = time, y= log(priorzdv))) + geom_point()
```

```{r}
 data %>% group_by(censor) %>% count()

ggplot(non_censored_diag, aes(x = time)) + geom_histogram() + facet_grid(.~sex)
non_censored_diag %>% group_by(sex) %>% count()
```

